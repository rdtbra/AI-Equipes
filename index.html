<!doctype html>
<html lang="pt-br" data-theme="light">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Launcher ‚Äì Equipes de IA</title>
  <link rel="icon" href="favicon.ico">
  <link rel="apple-touch-icon" href="assets/icon-192.png">
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#4f46e5">
  <style>
    :root{--bg:#f5f7fb;--fg:#0f172a;--muted:#475569;--card:#ffffff;--border:#e5e7eb;--accent:#4f46e5}
    :root[data-theme='dark']{--bg:#0b1020;--fg:#dce3ff;--muted:#97a0c6;--card:#0f152b;--border:#1e2a4a;--accent:#8b86ff}
    *{box-sizing:border-box} body{margin:0;background:var(--bg);color:var(--fg);font:16px/1.45 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif}
    .container{max-width:1100px;margin:0 auto;padding:24px}
    h1{margin:0;font-size:28px;font-weight:800;letter-spacing:-0.02em}
    p{margin:6px 0 0;color:var(--muted)}
    .toolbar{display:flex;flex-wrap:wrap;gap:10px;align-items:center;justify-content:space-between;margin:18px 0}
    .btn{border:1px solid var(--border);background:var(--card);color:var(--fg);border-radius:12px;padding:10px 14px;cursor:pointer}
    .btn:hover{background:rgba(255,255,255,.04)}
    .row{display:grid;grid-template-columns:1fr;gap:14px}
    .card{background:var(--card);border:1px solid var(--border);border-left:6px solid var(--accent);border-radius:16px;padding:16px;box-shadow:0 2px 6px rgba(15,23,42,.08)}
    .card h2{margin:0 0 10px 0;font-size:18px}
    .card .actions{display:flex;gap:8px;margin-bottom:10px;flex-wrap:wrap}
    .grid{display:grid;grid-template-columns:1fr;gap:8px}
    @media(min-width:840px){.grid{grid-template-columns:1fr 1fr}}
    .item{display:flex;gap:8px;align-items:center;border:1px solid var(--border);border-radius:12px;padding:8px;background:transparent}
    .item input[type='text']{border:1px solid var(--border);border-radius:10px;padding:8px;background:var(--card);color:var(--fg)}
    .name{flex:1 1 160px}
    .url{flex:2 1 300px}
    .small{font-size:13px;color:var(--muted)}
    .toggle{display:inline-flex;align-items:center;gap:8px;border:1px solid var(--border);border-radius:999px;padding:6px 10px;cursor:pointer;background:var(--card)}
    .switch{display:flex;align-items:center;gap:6px}
    .footer{display:flex;align-items:center;justify-content:space-between;margin-top:16px;color:var(--muted);font-size:13px}
  </style>
</head>
<body>
  <div class="container">
    <h1>Launcher ‚Äì Equipes de IA</h1>
    <p class="small">Dica: permita pop-ups para este site. Para abrir em <b>nova janela com v√°rias abas</b>, marque a op√ß√£o.</p>

    <div class="toolbar">
      <div style="display:flex;gap:8px;flex-wrap:wrap">
        <button class="btn" id="openAll">Abrir TUDO</button>
        <button class="btn" id="addGroup">+ Grupo</button>
        <button class="btn" id="export">Exportar</button>
        <button class="btn" id="import">Importar</button>
      </div>
      <div style="display:flex;align-items:center;gap:16px;flex-wrap:wrap">
        <div class="toggle" id="themeToggle" title="Alternar tema claro/escuro"><span>üåì</span><span id="themeLabel">Tema: Claro</span></div>
        <div class="switch"><input id="newWin" type="checkbox"><label for="newWin" class="small">Abrir em nova janela</label></div>
        <div style="display:flex;align-items:center;gap:8px">
          <label class="small">Atraso (ms)</label>
          <input class="btn" style="width:110px" type="number" id="delay" min="0" step="50" value="0">
        </div>
      </div>
    </div>

    <div id="groups" class="row"></div>

    <div class="footer">
      <span>Configura√ß√£o salva no navegador (localStorage).</span>
      <button class="btn" id="reset">Restaurar padr√£o</button>
    </div>
  </div>

<script>
const KEY = "ia-launcher-config-v1";
const DEFAULT_GROUPS = [{"id": "grp1", "name": "EMT-01-ES", "color": "#4f46e5", "items": [{"label": "Claude 4 Sonnet", "url": "https://app.adapta.one/chats/86a63d0c-6595-4549-9dd7-669dddd30ed5", "checked": true}, {"label": "Gemini 2.5 Flash", "url": "https://app.adapta.one/chats/a978446e-2d12-45d2-87dc-9e45a2bbea01", "checked": true}, {"label": "GPT-4o", "url": "https://chatgpt.com/g/g-p-68abc6e4e8508191b025b4e541779c61/c/6906449f-bb84-8332-9ef6-ec3e4c8325b4", "checked": true}, {"label": "Perplexity", "url": "https://app.adapta.one/chats/70088b16-aaff-4bc6-b6c7-6c91735274ab", "checked": true}, {"label": "Sabia 3.1", "url": "https://app.innerai.com/projects/5ab190c0-7035-46d4-8f06-450974e38bad?sessionId=69359d82-f860-414b-91f7-a79284ea3a80", "checked": true}, {"label": "GPT-5", "url": "https://chatgpt.com/g/g-p-68abc6e4e8508191b025b4e541779c61/c/68c7648c-6638-8004-a3d5-6f1d7e2b0cf6", "checked": true}, {"label": "Command R", "url": "https://app.innerai.com/projects/5ab190c0-7035-46d4-8f06-450974e38bad?sessionId=65ae6d64-cdf7-43fa-8aee-bf6938dd1f89", "checked": true}]}];

// THEME
const themePrefKey = "ia-launcher-theme";
function applyTheme(t){ document.documentElement.setAttribute('data-theme', t); document.getElementById('themeLabel').textContent = 'Tema: ' + (t==='dark'?'Escuro':'Claro'); }
function loadTheme(){ return localStorage.getItem(themePrefKey) || (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light'); }
function toggleTheme(){ const cur = document.documentElement.getAttribute('data-theme') || 'light'; const next = cur==='light'?'dark':'light'; applyTheme(next); localStorage.setItem(themePrefKey, next); }
applyTheme(loadTheme());
document.addEventListener('DOMContentLoaded', () => { document.getElementById('themeToggle').addEventListener('click', toggleTheme); });

// STORAGE
function load(){ try{ const j=localStorage.getItem(KEY); return j? JSON.parse(j): DEFAULT_GROUPS }catch(e){ return DEFAULT_GROUPS } }
function save(groups){ try{ localStorage.setItem(KEY, JSON.stringify(groups)) }catch(e){} }

let groups = load();
const groupsEl = document.getElementById("groups");
const delayEl = document.getElementById("delay");
const newWinEl = document.getElementById("newWin");

function render(){
  groupsEl.innerHTML = "";
  groups.forEach((g, gi) => {
    const card = document.createElement("div");
    card.className = "card";
    card.style.borderLeftColor = g.color || "#4f46e5";
    card.innerHTML = `
      <div style="display:flex;justify-content:space-between;align-items:center;gap:10px;margin-bottom:6px">
        <h2><span style="display:inline-block;width:12px;height:12px;border-radius:50%;background:${g.color || "#4f46e5"};margin-right:8px"></span>${escapeHtml(g.name || "Grupo")}</h2>
        <div class="actions">
          <button class="btn" data-act="open-group">Abrir todas</button>
          <button class="btn" data-act="add-item">+ IA</button>
          <button class="btn" data-act="edit-group">Editar</button>
          <button class="btn" data-act="remove-group">Remover</button>
        </div>
      </div>
      <div class="grid" data-role="grid"></div>
    `;
    const grid = card.querySelector("[data-role='grid']");
    (g.items || []).forEach((it, ii) => {
      const row = document.createElement("div");
      row.className = "item";
      const safeUrl = escapeAttr(it.url||"");
      row.innerHTML = `
        <input class="checkbox" type="checkbox" ${it.checked === false ? "" : "checked"} data-role="check">
        <input class="name" type="text" value="${escapeAttr(it.label||"")}" placeholder="Nome">
        <input class="url" type="text" value="${safeUrl}" placeholder="https://...">
        <a class="btn" href="${safeUrl}" target="_blank" rel="noopener noreferrer">Abrir</a>
        <button class="btn" data-act="remove">Remover</button>
      `;
      row.querySelector("[data-role='check']").addEventListener("change", e => { groups[gi].items[ii].checked = e.target.checked; save(groups); });
      row.querySelector(".name").addEventListener("input", e=>{ groups[gi].items[ii].label = e.target.value; save(groups); });
      row.querySelector(".url").addEventListener("input", e=>{ groups[gi].items[ii].url = e.target.value; save(groups); });
      row.querySelector("[data-act='remove']").addEventListener("click", ()=>{ groups[gi].items.splice(ii,1); save(groups); render(); });
      grid.appendChild(row);
    });

    card.querySelector("[data-act='add-item']").addEventListener("click", ()=>{ const url = prompt("Cole a URL (https://...)"); if(!url) return; const label = prompt("Nome curto (ex.: 'ChatGPT')") || url; groups[gi].items.push({label, url, checked:true}); save(groups); render(); });
    card.querySelector("[data-act='edit-group']").addEventListener("click", ()=>{ const name = prompt("Nome do grupo:", g.name || ""); if(name===null) return; const color = prompt("Cor (hex):", g.color || "#4f46e5"); if(color===null) return; groups[gi].name = name; groups[gi].color = color||"#4f46e5"; save(groups); render(); });
    card.querySelector("[data-act='remove-group']").addEventListener("click", ()=>{ if(!confirm("Remover grupo?")) return; groups.splice(gi,1); save(groups); render(); });
    card.querySelector("[data-act='open-group']").addEventListener("click", ()=>{ const urls = (groups[gi].items||[]).filter(i=>i.checked!==false && i.url).map(i=>i.url); openMany(urls, Number(delayEl.value||0), newWinEl.checked); });
    groupsEl.appendChild(card);
  });
}

function openMany(urls, delayMs=0, newWindow=false){
  if(!urls || !urls.length) { alert("Nenhuma URL selecionada."); return; }
  if(!newWindow){
    (async ()=>{ for(const u of urls){ try{ window.open(u, "_blank", "noopener,noreferrer"); }catch(e){ console.error(e); } if(delayMs>0) await new Promise(r=>setTimeout(r, delayMs)); } })();
    return;
  }
  // Try to open a single NEW WINDOW and then spawn tabs in it (best effort; browser-dependent)
  const features = "popup=yes,width=1280,height=800";
  let win = window.open("about:blank", "_blank", features);
  if(!win) { alert("O navegador bloqueou a nova janela. Permita pop-ups para este site."); return; }
  (async ()=>{
    try{ win.location = urls[0]; }catch(e){ console.error(e); }
    if(delayMs>0) await new Promise(r=>setTimeout(r, delayMs));
    for(let i=1;i<urls.length;i++){ try{ win.open(urls[i], "_blank"); }catch(e){ console.error(e); } if(delayMs>0) await new Promise(r=>setTimeout(r, delayMs)); }
    try{ win.focus(); }catch(_ ){}
  })();
}

function exportJson(){
  const blob = new Blob([JSON.stringify(groups,null,2)], {type:"application/json"});
  const url = URL.createObjectURL(blob);
  const a = document.createElement("a"); a.href=url; a.download="ia-launcher-config.json"; a.click();
  URL.revokeObjectURL(url);
}
function importJson(){
  const input = document.createElement("input"); input.type="file"; input.accept="application/json";
  input.onchange = e => { const f = e.target.files && e.target.files[0]; if(!f) return; const rd = new FileReader(); rd.onload = () => { try{ const data = JSON.parse(rd.result); if(Array.isArray(data)){ groups=data; save(groups); render(); } else alert("JSON inv√°lido"); } catch{ alert("Falha ao ler JSON"); } }; rd.readAsText(f); };
  input.click();
}
function escapeHtml(s){ return (s||"").replace(/[&<>]/g, c=> ({'&':'&amp;','<':'&lt;','>':'&gt;'}[c]) ); }
function escapeAttr(s){ return escapeHtml(s).replace(/"/g,"&quot;"); }

document.getElementById("openAll").addEventListener("click", ()=>{ const urls = groups.flatMap(g=>g.items||[]).filter(i=>i.checked!==false && i.url).map(i=>i.url); openMany(urls, Number(delayEl.value||0), newWinEl.checked); });
document.getElementById("addGroup").addEventListener("click", ()=>{ const name = prompt("Nome do grupo"); if(!name) return; const color = prompt("Cor (hex, ex.: #4f46e5)", "#4f46e5") || "#4f46e5"; groups.push({id:crypto.randomUUID ? crypto.randomUUID() : Math.random().toString(36).slice(2), name, color, items:[]}); save(groups); render(); });
document.getElementById("export").addEventListener("click", exportJson);
document.getElementById("import").addEventListener("click", importJson);
document.getElementById("reset").addEventListener("click", ()=>{ if(confirm("Restaurar configura√ß√£o padr√£o?")){ groups = DEFAULT_GROUPS; save(groups); render(); } });

render();
</script>
</body>
</html>
